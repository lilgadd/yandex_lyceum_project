# –†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π

##### –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π. 
##### –û–Ω —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤: 
* ##### –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è, —Ä–∞–∑–±–∏–≤–∞–µ—Ç –∏—Ö –Ω–∞ –ø–æ–¥–∑–∞–¥–∞—á–∏ –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º
* ##### –ê–≥–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å –ø–æ–º–æ—â—å—é –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏—è. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `COMPUTING_POWER`

 ##### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è, –≤—Ö–æ–¥–∏—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ API. –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ SQLite, –∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ HTTP

##### –í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç—Ä–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö SQLite:

1. ###### user_store.db ‚Äî —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
    ```
    id (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä)

    login

    password
    ```

2. ###### expression_store.db ‚Äî —Ö—Ä–∞–Ω–∏—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:
    ```
    id 

    user_id

    expression

    result

    status
    ```

3. ###### store.db ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∑–∞–¥–∞—á –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:
    ```
    id (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–¥–∞—á–∏)

    expression_id (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è)

    subexpression (–ø–æ–¥–≤—ã—Ä–∞–∂–µ–Ω–∏–µ)

    result (—Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–¥–∑–∞–¥–∞—á–∏)
    ```
status (–æ–∂–∏–¥–∞–µ—Ç, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –∑–∞–≤–µ—Ä—à–µ–Ω)
> ###### –ë–∞–∑—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞, –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.
**–°—Ö–µ–º–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤**
![—Å—Ö–µ–º–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤](images\dgrm.png)
## üì° API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

* #### `POST /api/v1/register`
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  
**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```
{
  "login": "your_username",
  "password": "your_password"
}
```

* #### `POST /api/v1/login`
–í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º—É, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JWT-—Ç–æ–∫–µ–Ω
**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```
{
  "login": "your_username",
  "password": "your_password"
}
```
**–û—Ç–≤–µ—Ç:**
```
{
  "token": "jwt_token"
}
```

#### üßÆ –†–∞–±–æ—Ç–∞ —Å –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏ (–Ω—É–∂–µ–Ω JWT –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization: Bearer <token>)

* #### `POST /api/v1/calculate`
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```
{
  "expression": "2 + 3 * (4 - 1)"
}
```

* #### `GET /api/v1/expressions`
–í—ã–≤–æ–¥–∏—Ç –≤—Å–µ –≤–≤–æ–¥–∏–º—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è
**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```
[
  {
    "id": "expression_id_1",
    "expression": "2 + 3 * (4 - 1)",
    "status": "–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è"
  },
  {
    "id": "expression_id_2",
    "expression": "5 * (6 + 2)",
    "status": "–∑–∞–≤–µ—Ä—à–µ–Ω",
    "result": 40
  }
]
```

* #### `GET /api/v1/expressions/{id}`
–í—ã–≤–æ–¥–∏—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –∞–π–¥–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —É–∫–∞–∑–∞–Ω –≤ –∑–∞–ø—Ä–æ—Å–µ
**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```
{
  "id": "expression_id",
  "expression": "2 + 3 * (4 - 1)",
  "result": 11,
  "status": "–∑–∞–≤–µ—Ä—à–µ–Ω"
}
```

#### ‚öôÔ∏è –†–∞–±–æ—Ç–∞ –∞–≥–µ–Ω—Ç–∞

* #### `GET /internal/task`
–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∑–∞–¥–∞—á—É —É –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```
{
  "task_id": "task_id",
  "expression_id": "expression_id",
  "subexpression": "3 * (4 - 1)"
}
```
* #### `POST /internal/task`
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä—É
**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```
{
  "id": "expression_id",
  "result": 9
}
```
___
## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω [Go](https://go.dev/) –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `COMPUTING_POWER` –∑–∞–¥–∞–Ω–∞.
> `COMPUTING_POWER` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ cmd\agent\main.go –≤ —Ñ—É–Ω–∫—Ü–∏–∏: main.go(){}, –ø–æ –¥–µ—Ñ–æ–ª—Ç—É `COMPUTING_POWER` = "2", –Ω–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ 
### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```
git clone https://github.com/lilgadd/yandex_lyceum_project.git
```
```
cd yandex_lyceum_project
```
### 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∏ –∞–≥–µ–Ω—Ç–∞
>##### ‚ÄºÔ∏è–í–ê–ñ–ù–û‚ÄºÔ∏è–°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä, –ø–æ—Ç–æ–º –∞–≥–µ–Ω—Ç
```
go run cmd/orchestrator/main.go
```
```
go run cmd/agent/main.go
``` 

#### ‚úÖ –¢–µ–ø–µ—Ä—å —Å–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
```
http://localhost:8080 ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä
http://localhost:8081 ‚Äî –∞–≥–µ–Ω—Ç
```
___
#### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

* #### `POST /api/v1/register`
>–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å

`–°—Ç–∞—Ç—É—Å 200 OK:`
```
curl -X POST http://localhost:8080/api/v1/register \
  -H "Content-Type: application/json" \
  -d '{
    "login": "exampleuser",
    "password": "examplepassword"
  }'
```
`–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—à–∏–±–∫–∏: "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç" –∏ —Å—Ç–∞—Ç—É—Å–æ–º: 400 Bad Request –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å —Å —Ç–µ–º–∏ –∂–µ –¥–∞–Ω–Ω—ã–º–∏`

`–û—à–∏–±–∫–∞: "–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ" –∏ —Å—Ç–∞—Ç—É—Å: 400 Bad Request:`
>–ü–æ–ª–µ login –∏–ª–∏ password(–∏–ª–∏ –æ–±–∞ –≤–º–µ—Å—Ç–µ) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—É—Å—Ç—ã
```
curl -X POST http://localhost:8080/api/v1/register \
  -H "Content-Type: application/json" \
  -d '{
    "login": "",
    "password": "examplepassword"
  }'
```
```
curl -X POST http://localhost:8080/api/v1/register \
  -H "Content-Type: application/json" \
  -d '{
    "login": "exampleuser",
    "password": ""
  }'
```
```
curl -X POST http://localhost:8080/api/v1/register \
  -H "Content-Type: application/json" \
  -d '{
    "login": "",
    "password": ""
  }'
```
`–û—à–∏–±–∫–∞: "–Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö" –∏ —Å—Ç–∞—Ç—É—Å 400 Bad Request:`
```
curl -X POST http://localhost:8080/api/v1/register \
  -H "Content-Type: application/json" \
  -d '{
    "login": "exampleuser",
  }'
```
* #### `POST /api/v1/login`
`–°—Ç–∞—Ç—É—Å: 200 OK, –≤–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å, —á—Ç–æ –≤–≤–æ–¥–∏–ª–∏ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏`
```
curl -X POST http://localhost:8080/api/v1/login \
  -H "Content-Type: application/json" \
  -d '{
    "login": "exampleuser",
    "password": "examplepassword"
  }'
```
**–û—Ç–≤–µ—Ç:**
```
{
  "token": "jwt_token"
}
```
`–û—à–∏–±–∫–∞: "–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", —Å—Ç–∞—Ç—É—Å: 400 Bad Request`
```
curl -X POST http://localhost:8080/api/v1/login \
  -H "Content-Type: application/json" \
  -d '{
    "login": "exampleuser",
  }'
```

* #### `POST /api/v1/calculate`
`–°—Ç–∞—Ç—É—Å: 201`
>‚ÄºÔ∏è–ù–µ –∑–∞–±—É–¥—å—Ç–µ –≤—Å—Ç–∞–≤–∏—Ç—å JWT-—Ç–æ–∫–µ–Ω
```
curl -X POST http://localhost:8080/api/v1/calculate \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE" \
  -d '{
    "expression": "(2 + 3) * 4"
  }'
```
**–û—Ç–≤–µ—Ç:**
```
{
    "id": "expression_id"
}
```
`–û—à–∏–±–∫–∞: "–≤—ã—Ä–∞–∂–µ–Ω–∏–µ –ø—É—Å—Ç–æ–µ", —Å—Ç–∞—Ç—É—Å: 422 Unprocessable Entity`
```
curl -X POST http://localhost:8080/api/v1/calculate \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE" \
  -d '{
    "expression": ""
  }'
```
`–û—à–∏–±–∫–∞: "–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", —Å—Ç–∞—Ç—É—Å: 422 Unprocessable Entity`
```
curl -X POST http://localhost:8080/api/v1/calculate \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE" \
  -d '{
    "expression": "abc"
  }'
```
`–û—à–∏–±–∫–∞: "–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏", —Å—Ç–∞—Ç—É—Å: 422`
```
curl -X POST http://localhost:8080/api/v1/calculate \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer " \
  -d '{
    "expression": "abc"
  }'
```
* #### `GET /api/v1/expressions`
–í—ã–≤–æ–¥–∏—Ç –≤—Å–µ –≤–≤–æ–¥–∏–º—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è
`–°—Ç–∞—Ç—É—Å: 200 OK`
```
curl -X GET http://localhost:8080/api/v1/expressions \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE"
```
``–û—à–∏–±–∫–∞: "–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", —Å—Ç–∞—Ç—É—Å: 500 Internal Server Error`
```
curl -X GET http://localhost:8080/api/v1/expressions \
  -H "Authorization: Bearer "
```
* #### `GET /api/v1/expressions/{id}`
`–°—Ç–∞—Ç—É—Å: 200 OK`
>‚ÄºÔ∏è–ù–µ –∑–∞–±—É–¥—å—Ç–µ —É–∫–∞–∑–∞—Ç—å –∞–π–¥–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
```
curl -X GET http://localhost:8080/api/v1/expressions/EXPRESSION_ID \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE"
```
`–û—à–∏–±–∫–∞: "–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", —Å—Ç–∞—Ç—É—Å: 500 Internal Server Error`
```
curl -X GET http://localhost:8080/api/v1/expressions/EXPRESSION_ID \
  -H "Authorization: Bearer "
```
`–û—à–∏–±–∫–∞: "–≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ", —Å—Ç–∞—Ç—É—Å: 404 Not Found`
>–£–∂–µ –≥–æ—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å, –Ω–∏—á–µ–≥–æ –∏–∑–º–µ–Ω—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ
```
curl -X GET http://localhost:8080/api/v1/expressions/0 \
  -H "Authorization: Bearer "
```